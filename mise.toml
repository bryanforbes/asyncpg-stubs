[settings]
lockfile = true

[settings.python]
venv_stdlib = true

[tools]
cargo-binstall = "1.17.5"
"cargo:git-cliff" = "2.12.0"
poetry = "2.3.2"
# 3.9 is after 3.10 so the virtualenv gets created with 3.10 by default
python = ["3.10.19", "3.9.25", "3.11.14", "3.12.12", "3.13.12", "3.14.3"]

[env]
_.python.venv = { path = ".venv", create = true }

[hooks]
postinstall = '''
{% if mise_env is not containing("ci") %}
  poetry install --all-extras
{% endif %}
'''

[tasks.stubtest]
description = "Run stubtest against asyncpg"
run = 'poetry run stubtest asyncpg --allowlist=stubtest-allow.txt'
